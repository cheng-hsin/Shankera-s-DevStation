---
title: 'AWS OpenVPN è¨­å®šæµç¨‹ - OpenVPN Access Serverï¼ˆAWS Marketplace ç‰ˆï¼‰'
date: '2025-07-10'
lastmod: '2025-07-10'
tags: ['aws', 'openvpn', 'networking', 'security']
draft: false
summary: 'AWS OpenVPN è¨­å®šæµç¨‹çš„è©³ç´°æ­¥é©Ÿå’Œæ³¨æ„äº‹é …'
layout: PostSimple
bibliography: references-data.bib
canonicalUrl: https://tailwind-nextjs-starter-blog.vercel.app/blog/new-features-in-v1/
---

æä¾› Web UI ç®¡ç†ã€ä½¿ç”¨è€…èªè­‰ã€æ›´å‹å–„çš„æ“ä½œç•Œé¢ã€‚

---

## ğŸ“˜ å‰ç½®æº–å‚™äº‹é …

- AWS VPC å·²å»ºç«‹ï¼Œä¸¦é–‹å•Ÿ VPN ç›¸é—œ Portï¼ˆTCP 943ã€UDP 1194ã€TCP 443ï¼‰
- æ“æœ‰ AWS EC2 æ“ä½œæ¬Šé™
- å»ºè­°ä½¿ç”¨ Elastic IP ç¶å®š OpenVPN Server

---

## ğŸ”¹ è¨­å®šæµç¨‹

1.  å¾ AWS Marketplace å»ºç«‹ OpenVPN Access Server AMI

    - æœå°‹ `OpenVPN Access Server`
    - é¸æ“‡åˆé©ç‰ˆæœ¬ï¼ˆæ¨è–¦ Ubuntu ç‰ˆï¼‰
    - å»ºç«‹ EC2 ä¸¦é¸æ“‡é©ç•¶çš„ security groupï¼š

      ```
      é–‹æ”¾ Port:
      TCP 22    - SSH
      TCP 443   - Web VPN Portal
      TCP 943   - Admin Web UI
      UDP 1194  - OpenVPN é€£ç·š
      ```

      ![openvpn setting](/static/images/2025-07-10_openvpn_setting/1.png)

      ![openvpn setting](/static/images/2025-07-10_openvpn_setting/2.png)

2.  åˆ†é…ä¸¦ç¶å®š Elastic IP è‡³è©² EC2

3.  é€é Web UI ç™»å…¥

    - ç®¡ç†ä»‹é¢ï¼šhttps://&lt;ElasticIP&gt;:943/admin
    - ä½¿ç”¨è€…ä»‹é¢ï¼šhttps://&lt;ElasticIP&gt;:943
    - é è¨­å¸³å¯†ï¼šopenvpn / openvpnï¼ˆé¦–æ¬¡ç™»å…¥æœƒè¦æ±‚æ›´æ”¹ï¼‰  
      ä¹Ÿå¯ä»¥ç”¨æŒ‡ä»¤æ”¹å¯†ç¢¼

      ````
      //Create or reset the openvpn administrative local account with specified password

              cd /usr/local/openvpn_as/scripts
              ./sacli --user "openvpn" --key "prop_superuser" --value "true" UserPropPut
              ./sacli --user "openvpn" --key "user_auth_type" --value "local" UserPropPut
              ./sacli --user "openvpn" --new_pass '<PASSWORD>' SetLocalPassword
              ./sacli start
              ```
      ````

4.  å»ºç«‹ä½¿ç”¨è€…å¸³è™Ÿ

    - ç™»å…¥ç®¡ç†ä»‹é¢ > User Management > User Permissions
    - å»ºç«‹æ–°å¸³è™Ÿï¼Œä¸¦è¨­ç‚º Allow Auto-login æˆ–å…è¨±ç™»å…¥

5.  ä¸‹è¼‰é€£ç·šæª”æ¡ˆï¼ˆ.ovpnï¼‰

    - ä½¿ç”¨è€…ç™»å…¥ https://&lt;ElasticIP&gt;:943
    - ç™»å…¥å¾Œå¯ç›´æ¥ä¸‹è¼‰å°æ‡‰ä½œæ¥­ç³»çµ±çš„é€£ç·šæª”æ¡ˆæˆ–å®‰è£ OpenVPN å®¢æˆ¶ç«¯

6.  æ¸¬è©¦é€£ç·š
    - ä½¿ç”¨ OpenVPN Connect æˆ– Tunnelblick å°‡ .ovpn æª”è¼‰å…¥
    - é€£ç·šä¸¦ç¢ºèªæ˜¯å¦å¯é€šå¾€å…§éƒ¨è³‡æºï¼ˆå¦‚ VPC ç§ç¶²æ®µï¼‰

---

## âœ… å„ªé»

- æä¾›åœ–å½¢åŒ– Web ç®¡ç†ç•Œé¢
- æ”¯æ´æ•´åˆ LDAPã€RADIUSã€SAML ç­‰èº«åˆ†é©—è­‰
- å¯è¨­å®šä½¿ç”¨è€…æ¬Šé™èˆ‡å­˜å–æ§åˆ¶
- è‡ªå¸¶æ†‘è­‰ç®¡ç†èˆ‡è‡ªå‹•ç°½ç™¼æ©Ÿåˆ¶
- è¨˜éŒ„ç”¨æˆ¶æµé‡èˆ‡é€£ç·šæ—¥èªŒ

---

Terraform

```bash
    resource "tls_private_key" "openvpn_key_5users" {
      algorithm = "RSA"
      rsa_bits  = 4096
    }

    resource "aws_key_pair" "openvpn_key_5users" {
      key_name   = "openvpn-key-5users"
      public_key = tls_private_key.openvpn_key_5users.public_key_openssh
    }

    resource "local_file" "private_key_pem_5users" {
      filename        = "${path.module}/openvpn-key-5users.pem"
      content         = tls_private_key.openvpn_key_5users.private_key_pem
      file_permission = "0400"
    }

    resource "aws_instance" "openvpn_5users" {
      ami                         = "ami-0c061d4b0dae75d55"
      instance_type               = "t3a.medium"
      subnet_id                   = "å­ç¶²id(subnet-XXXXXXX)"
      vpc_security_group_ids      = ["ä½ çš„å®‰å…¨ç¾¤çµ„id(sg-XXXXXXX)"]
      key_name                    = aws_key_pair.openvpn_key_5users.key_name
      disable_api_termination     = true
      associate_public_ip_address = true

      tags = {
        Name = "OpenVPN-Server-5users"
      }
    }

    output "openvpn_5users_public_ip" {
      value = aws_instance.openvpn_5users.public_ip
    }
```
