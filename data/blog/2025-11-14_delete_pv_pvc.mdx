---
title: '安全刪除 Kubernetes PV/PVC 操作指南（ GPT 自動生成指令 ）'
date: '2025-11-14'
lastmod: '2025-11-14'
tags: ['kubernetes', 'pv', 'pvc']
draft: false
summary: '本文介紹如何安全地刪除 Kubernetes 中的 PV 和 PVC。'
layout: PostSimple
bibliography: references-data.bib
canonicalUrl: https://tailwind-nextjs-starter-blog.vercel.app/blog/new-features-in-v1/
---

## 1️⃣ 先取得 PV 列表

在操作前，先查看 Kubernetes 中目前所有 PV 狀態：

```bash
kubectl get pv
```

會看到類似這樣的輸出：

```
NAME                                               CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS      CLAIM
atrix-staging-taiwan-mongodb                       8Gi        RWO            Retain           Released    atrix-staging-taiwan/atrix-staging-taiwan-mongodb
data-atrix-staging-taiwan-kafka-controller-0       8Gi        RWO            Retain           Bound       atrix-staging-taiwan/data-atrix-staging-taiwan-kafka-controller-0
redis-data-atrix-staging-taiwan-redis-master-0     8Gi        RWO            Retain           Available   atrix-staging-taiwan/redis-data-atrix-staging-taiwan-redis-master-0
```

---

## 2️⃣ 使用 GPT 自動生成刪除指令（建議優先使用）

將 `kubectl get pv` 的輸出貼給 GPT，可以自動生成安全的刪除指令清單：

### GPT Prompt 範例

`````
    我會提供 Kubernetes PV 列表，格式就是 `kubectl get pv` 的輸出。請你幫我生成
    **一個一個安全刪除 PV 的指令清單**，包括：

    1. 如果 PV 狀態是 Bound，先找到對應的 PVC 並生成刪除 PVC 的命令。
    2. 如果 PV 狀態是 Released 或 Available，直接生成刪除 PV 的命令。
    3. 保持命令順序，先刪 PVC 再刪 PV，確保不會刪錯還在使用的 PV。

    下面是範例 PV 列表（我會貼實際輸出）：

        ````

        NAME                                               CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS      CLAIM
        atrix-staging-taiwan-mongodb                       8Gi        RWO            Retain           Released    atrix-staging-taiwan/atrix-staging-taiwan-mongodb
        data-atrix-staging-taiwan-kafka-controller-0       8Gi        RWO            Retain           Bound       atrix-staging-taiwan/data-atrix-staging-taiwan-kafka-controller-0
        redis-data-atrix-staging-taiwan-redis-master-0     8Gi        RWO            Retain           Available   atrix-staging-taiwan/redis-data-atrix-staging-taiwan-redis-master-0

        ````

    請生成對應的 kubectl 命令，例如：

    ````bash
    kubectl delete pvc <pvc-name> -n <namespace>
    kubectl delete pv <pv-name>
    ````

    命令要**安全且按順序執行**。

`````

---

## 3️⃣ 手動操作流程（如不使用 GPT）

1. **刪除 Bound PV 對應 PVC**
   ```bash
   kubectl get pvc -n <namespace>
   kubectl delete pvc <pvc-name> -n <namespace>
   ```

````

2. **刪除 Released / Available PV**

   ```bash
   kubectl delete pv <pv-name>
   ```

3. **確認刪除結果**

   ```bash
   kubectl get pv
   ```

---

## 4️⃣ 注意事項

* **順序很重要**：先刪 PVC，再刪 PV，避免刪掉仍在使用的 PV。
* **資料清理**：PV 對應底層存儲資料可能仍存在，需要手動清理。
* **命名與 namespace**：確認 PVC 名稱與 namespace，以免刪錯資源。

---
````
